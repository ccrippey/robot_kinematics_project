#:kivy 2.3.1

<KeyframeEditor>:
    BoxLayout:
        orientation: 'vertical'
        padding: 0
        spacing: 0

        BoxLayout:
            orientation: 'vertical'
            padding: 10    
            spacing: 10      
            size_hint_y: None
            height: top_bar1.height + top_bar2.height + 40  

            BoxLayout:
                id: top_bar1
                size_hint_y: None
                height: '48dp'
                spacing: 10
                Button:
                    text: 'Home'
                    on_release: root.go_home()
                Button:
                    text: 'Animation Play'
                    on_release: root.go_animation()
                Button:
                    text: 'Clear All Frames'
                    on_release: root.clear_frames()

            BoxLayout:
                id: top_bar2
                size_hint_y: None
                height: '48dp'
                spacing: 10
                Label:
                    text: 'Viewing Angle:'
                    color: 0,0,0,1
                    size_hint_x: None
                    width: '100dp'
                Spinner:
                    text: str(root.projection_mode)
                    values: ["-90", "-45","0", "45", "90"]
                    size_hint_x: None
                    width: '140dp'
                    on_text: root.projection_mode = float(self.text)
                Label:
                    text: 'Time (s):'
                    color: 0, 0, 0, 1
                    size_hint_x: None
                    width: '70dp'
                TextInput:
                    id: time_input
                    text: f'{root.current_time:.2f}'
                    multiline: False
                    size_hint_x: None
                    width: '80dp'
                    on_text_validate: root.on_time_changed(self.text)
                    hint_text: '0.00'
                Label:
                    text: 'Interp Before:'
                    color: 0, 0, 0, 1
                    size_hint_x: None
                    width: '100dp'
                Spinner:
                    id: interp_before_spinner
                    text: root.current_interp_before
                    values: root.interp_choices
                    size_hint_x: None
                    width: '120dp'
                    on_text: root.on_interp_before_changed(self.text)
                Label:
                    text: 'Interp After:'
                    color: 0, 0, 0, 1
                    size_hint_x: None
                    width: '90dp'
                Spinner:
                    id: interp_after_spinner
                    text: root.current_interp_after
                    values: root.interp_choices
                    size_hint_x: None
                    width: '120dp'
                    on_text: root.on_interp_after_changed(self.text)
                # Widget:
                #     size_hint_x: 0.3
                Button:
                    text: '<<'
                    size_hint_x: None
                    width: '50dp'
                    on_release: root.prev_frame()
                Spinner:
                    id: frame_spinner
                    size_hint_x: None
                    width: '140dp'
                    text: str(root.current_index + 1)
                    values: root.frame_choices
                    on_text: root.on_frame_chosen(self.text)
                Button:
                    text: '>>'
                    size_hint_x: None
                    width: '50dp'
                    on_release: root.next_frame()

            # BoxLayout:
            #     id: top_bar3
            #     size_hint_y: None
            #     height: '42dp'
            #     spacing: 10
               

            # BoxLayout:
            #     id: top_bar4
            #     size_hint_y: None
            #     height: '42dp'
            #     spacing: 10


        RelativeLayout:
            id: canvas_area
            canvas.before:
                Color:
                    rgba: 0.95, 0.95, 0.97, 1
                Rectangle:
                    pos: self.pos
                    size: self.size

            FloatLayout:
                id: ghost_layer
                opacity: 0
                PoseEditor:
                    id: ghost_pose

            PoseEditor:
                id: current_pose
